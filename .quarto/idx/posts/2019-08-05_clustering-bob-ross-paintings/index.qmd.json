{"title":"Exploring Bob Ross paintings","markdown":{"yaml":{"title":"Exploring Bob Ross paintings","date":"2019-08-14","slug":"exploring-bob-ross-paintings","categories":["R","Code","Visualization"],"description":"Using the tidyverse and PCA to explore the features of Bob Ross' paintings.","image":"/img/mountains-unsplash.jpg"},"headingText":"Set up","containsRefs":false,"markdown":"\n\n<!-- \ncover img: https://unsplash.com/photos/r53rNKb_7s8\nartist: Bob Canning\nlicence: unsplash free-to-use \n-->\n\nIn this post, I try something new and share an analysis I did without stopping to explain the code along the way (with a few exceptions). I analyze a dataset on Bob Ross paintings from last week's Tidytuesday, an initiative by the [R for Data Science online learning community](https://www.rfordatasci.com/). Each Monday, a new dataset is posted on [GitHub](https://github.com/rfordatascience/tidytuesday) with a short description. You can see some analyses and visualizations people have done by searching for the [#tidytuesday hashtag on Twitter](https://twitter.com/search?q=%23tidytuesday). \n\nIn this dataset, each row describes a painting Bos Ross (or a guest) did on his show, with the episode, season, title, and a column for each feature (e.g. \"tree\", \"mountain\") that is 1 if that painting included that feature and 0 otherwise. Let's go exploring! \n\n\n```{r message = FALSE, warning = FALSE}\nlibrary(tidyverse)\nggthemr::ggthemr('fresh')\n\nbob_ross <- read_csv(\"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-08-06/bob-ross.csv\")\n\n# copied from tidytuesday repo\nbob_ross <- bob_ross %>%\n  janitor::clean_names() %>% \n  separate(episode, into = c(\"season\", \"episode\"), sep = \"E\") %>% \n  mutate(season = str_extract(season, \"[:digit:]+\")) %>% \n  mutate_at(vars(season, episode), as.integer) %>%\n  # added to clean up title\n  mutate(title = str_remove_all(title, '\"')) \n\nbob_ross %>%\n  head(5) %>%\n  select(1:7) %>%\n  knitr::kable()\n```\n\n## Exploratory graphs\n\nLet's start with some basic data exploration. What are the ten most frequent features in his paintings?\n\n```{r}\nbob_ross %>%\n  summarize_at(vars(apple_frame:wood_framed), ~ sum(.)) %>%\n  gather(feature, nb_paintings) %>%\n  mutate(feature = fct_reorder(feature, nb_paintings)) %>%\n  top_n(10, nb_paintings) %>%\n  ggplot(aes(x = feature, y = nb_paintings)) + \n  geom_col() + \n  coord_flip() + \n  labs(y = \"Number of paintings\", \n       title = \"What were most common features in Bob Ross paintings?\",\n       x = \"\")\n```\n\nIf you've seen Bob Ross paintings, it's probably not too surprising that \"tree\" is the top feature. I am a bit surprised to find that trees, deciduous, and conifer are all separate features (the latter two are types of trees). \n\nLet's adapt this to show what percent of paintings contained the feature, rather than the total number. \n\n```{r}\nbob_ross %>%\n  summarize_at(vars(apple_frame:wood_framed), ~ sum(.)) %>%\n  gather(feature, nb_paintings) %>%\n  mutate(total_paintings = nrow(bob_ross),\n         pct_w_feature = nb_paintings / total_paintings,\n         feature = fct_reorder(feature, pct_w_feature)) %>%\n  top_n(10, pct_w_feature) %>%\n  ggplot(aes(x = feature, y = pct_w_feature)) + \n  geom_col() + \n  coord_flip() + \n  labs(y = \"Percent of paintings with feature\", \n       title = \"What were most common features in Bob Ross paintings?\",\n       x = \"\") + \n  scale_y_continuous(label = scales::percent) + \n  expand_limits(y = 1)\n```\n\nThis gives some more context of just how common having a tree was - more than 80% of the paintings had one!\n\nDid the content of the paintings change over time? We can answer this question in a lot of different ways - let's start by looking at features that appeared in more than 150 paintings and their trends over the seasons. \n\n```{r}\nnb_features_by_season <- bob_ross %>%\n  group_by(season) %>%\n  summarize_at(vars(apple_frame:wood_framed), ~ sum(.)) %>%\n  gather(feature, nb_paintings, -season)\n```\n\n```{r}\nnb_features_by_season %>%\n  add_count(feature, wt = nb_paintings, name = \"nb_total\") %>%\n  filter(nb_total > 150) %>%\n  ggplot(aes(x = season, y = nb_paintings, color = feature)) + \n  geom_line() + \n  facet_wrap(~ feature) + \n  labs(y = \"Number of paintings with feature\",\n       title = \"Bob Ross always loved trees, but fell out of love with clouds\",\n       subtitle = \"Dashed line is number of episodes in the season\") + \n  geom_hline(yintercept = 13, lty = 2) + \n  theme(legend.position = \"none\") + \n  expand_limits(y = 0)\n```\n\nTrees (of all types) stay consistently popular across seasons, while clouds became less featured.\n\nWhat features have the great absolute difference between the first and second half of the series? \n\n```{r}\nby_feature_half <- nb_features_by_season %>%\n  mutate(season_half = if_else(season <= 15, \"first\", \"second\")) %>%\n  group_by(season_half, feature) %>%\n  summarize(nb_paintings = sum(nb_paintings)) %>%\n  ungroup() %>%\n  mutate(nb_paintings = ifelse(season_half == \"first\", \n                               nb_paintings / (15 * 67), \n                               nb_paintings / (16 * 67))) %>%\n  spread(season_half, nb_paintings) %>%\n  mutate(difference = second - first) %>%\n  top_n(10, abs(difference)) %>%\n  gather(season_half, nb_paintings, first, second)\n\nby_feature_half %>%\n  mutate(feature = fct_reorder(feature, difference, .desc = TRUE),\n         season_half = ifelse(season_half == \"first\", \"1-15\", \"16-31\")) %>%\n  ggplot(aes(nb_paintings, feature)) +\n  geom_line() +\n  geom_point(aes(color = season_half)) +\n  scale_color_manual(values = c(\"#E84646\", \"#233B43\")) + \n  scale_x_continuous(labels = scales::percent) + \n  labs(x = \"Percent of paintings with feature\",\n       y = \"\",\n       title = \"What features became more or less frequent?\",\n       color = \"Seasons\")\n```\n\nAs we had seen in our graph of the top 6 features, clouds (and it's like, cumuls and cirrus) went down, while framed got a little more popular. \n\nWhat's the distribution of the number of features per painting (code for a calculating the summary of a row thanks to [this tweet](https://twitter.com/JennyBryan/status/1158571075388575745) by Jenny Bryan)? \n\n```{r}\nbob_ross %>%\n  mutate(nb_features = select_at(., vars(apple_frame:wood_framed)) %>% pmap_dbl(sum)) %>%\n  ggplot(aes(x = nb_features)) + \n  geom_histogram(bins = 16) + \n  labs(x = \"Number of features in a painting\",\n       y = \"Number of paintings\",\n       title = \"Most paintings had between 5 and 11 features\")\n```\n\nMost paintings have between 5 and 11 features, although one has more than 15 and a couple have none. \n\n## Principal Component Analysis\n\nIn short, principal component analysis is a dimensionality-reduction technique that takes all of your variables and creates a new set of characteristics that still contains the most information. For more information, I highly recommend checking out [this StackOverflow answer](https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues) for great explanations from simple to mathematical and Julia Silge's [post](https://juliasilge.com/blog/stack-overflow-pca/) where she explains principal component analysis using StackOverflow data.\n\nWe'll start by selecting only features that appear in at least 5 paintings and calculate three principal components, adding `scale = TRUE` to scale the features. This is a critical step; while the features are all on the same scale (0 or 1, not say 0 or 100 for one and 0 or 50 for another), they have different variances as some have a lot of 1s and some a lot of 0s. We need to center our data so that they all have the same mean and variance.\n\n```{r}\nbob_ross_for_pca <- bob_ross %>% \n  select(-season, -episode, -title)  %>%\n  select_if(~ sum(.) >= 5)\n```\n\n```{r}\ntags_pca <- irlba::prcomp_irlba(bob_ross_for_pca, n = 3, scale. = TRUE)\n\ntidied_pca <- bind_cols(feature = colnames(bob_ross_for_pca),\n                        as_tibble(tags_pca$rotation)) %>%\n  gather(PC, value, PC1:PC3)\n```\n\nLet's take a look at which features have the most relative importance (highest absolute value) for each component. We're going to use the new `tidytext` functions `reorder_within()` and `scale_x_reordered()` to make the features ordered within each plot (see Julia Silge's [post](https://juliasilge.com/blog/reorder-within/) for more).\n\n```{r fig.height = 6}\nlibrary(tidytext)\n\ntidied_pca %>%\n  group_by(PC) %>%\n  top_n(8, abs(value)) %>%\n  ungroup() %>%\n  ggplot(aes(x = reorder_within(feature, value, PC), y = value)) +\n  geom_col() + \n  coord_flip() + \n  facet_wrap(~ PC, scales = \"free\", ncol = 1) + \n  scale_x_reordered() + \n  labs(title = \"What distinguishes Bob Ross paintings?\",\n       subtitle = \"Trees vs. beach, structures vs. mountains, and water vs. winter structures\", y = \"Relative importance in principal component\",\n       x = \"\")\n```\n\nWe find that the first principal component divides painting between those at the ocean (with beach and palm trees) and those in the tree covered mountains. The next component divides mountains from structures like cabin and barns, while the final one distinguishes a cabin in the snow from a grassy river. \n\n## Conclusion \n\nI hope you enjoyed this new style of post and were able to learn some new tricks along the way. Let me know what you think on [twitter](https://twitter.com/robinson_es)! \n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.242","theme":"../../custom.scss","title-block-banner":true,"author":[{"name":"Emily Robinson"}],"toc-title":"Table of contents","toc-location":"left","title":"Exploring Bob Ross paintings","date":"2019-08-14","slug":"exploring-bob-ross-paintings","categories":["R","Code","Visualization"],"description":"Using the tidyverse and PCA to explore the features of Bob Ross' paintings.","image":"/img/mountains-unsplash.jpg"},"extensions":{"book":{"multiFile":true}}}}}